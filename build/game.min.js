!function(){"use strict";function t(t,e,n,i){this.x=t,this.y=e,this.width=n,this.height=i}function e(t,e,n,i,o,r){let s=document.createElement("img"),h=document.createElement("img");s.addEventListener("error",function(){console.log("Image failed!")},!1),s.addEventListener("load",function(){let t=document.createElement("canvas"),e=t.getContext("2d");t.width=s.width,t.height=s.height,e.drawImage(s,0,0,s.width,s.height,0,0,t.width,t.height),h.src=t.toDataURL("image/png")},!1),s.src=t,this.frameSize=e,this.row=o,this.col=r,this.frames=n,this.frameRate=i,this.timer=0,this.currentFrame=0,this.image=h}function n(t,e,n,i){this.x=t,this.y=e,this.time=0,this.width=n,this.height=i}function i(t,e){n.call(this,t,e,40,40),this.rangeOfMovement=4,this.move(0)}function o(t,e,i,o){n.call(this,t,e,40,10),this.invisPointY=o,this.speed=i}let r,s,h;t.prototype.left=function(){return this.x},t.prototype.right=function(){return this.x+this.width},t.prototype.top=function(){return this.y},t.prototype.bottom=function(){return this.y+this.height},t.prototype.intersects=function(t){return this.right()>=t.left()&&this.left()<=t.right()&&this.top()<=t.bottom()&&this.bottom()>=t.top()},t.prototype.union=function(t){var e,n,i,o;void 0!==t&&(e=Math.min(this.x,t.x),n=Math.min(this.y,t.y),i=Math.max(this.right(),t.right())-Math.min(this.left(),t.left()),o=Math.max(this.bottom(),t.bottom())-Math.min(this.top(),t.top()),this.x=e,this.y=n,this.width=i,this.height=o)},e.prototype.update=function(t){this.timer+=t,this.timer>1/this.frameRate&&(this.timer=0,this.currentFrame=(this.currentFrame+1)%this.frames)},n.prototype.update=function(t){this.time+=t},n.prototype.collisionRect=function(){return new t(this.x-this.width/2,this.y-this.height/2,this.width,this.height)},i.prototype=Object.create(n.prototype),i.prototype.update=function(t){n.prototype.update.call(this,t)},i.prototype.move=function(t){this.x=r.INITIAL_WIDTH()/this.rangeOfMovement*t+20},o.prototype=Object.create(n.prototype),o.prototype.update=function(t){n.prototype.update.call(this,t),this.y+=this.speed},h=function(){let t=[];return{update:function(e){let n,i=s.enemies(),o=s.player(),h=o.collisionRect();for(n=i.length-1;n>=0;n--){let e=i[n],c=e.collisionRect();e&&o&&c.intersects(h)?s.setGameOver():e&&c.top()>r.INITIAL_HEIGHT()&&(t.push(e),s.addScore(1))}},clearOffScreenEntities:function(){t&&(t=t.filter(function(e){return!t.includes(e)}))},offScreenEntities:function(){return t}}}(),r=function(){let t=new e("build/sprites/animals.png",[26,36],1,1,3,4),n=new e("build/sprites/animals.png",[26,36],3,3,4,6),r=[].concat(t,n),h=document.getElementById("gameWindow"),c=h.getContext("2d");const a=720,u=480,f=u/a;let l=a,d=u,p=navigator.userAgent.toLowerCase(),g=p.indexOf("android")>-1,m=p.indexOf("iphone")>-1||p.indexOf("ipad")>-1;function y(){l=window.innerHeight,d=l*f,(g||m)&&(document.body.style.height=window.innerHeight+50+"px"),h.style.width=d+"px",h.style.height=l+"px",window.setTimeout(function(){window.scrollTo(0,1)},1)}function I(t,e,n,i){let o=t.frameSize[1],r=t.frameSize[0];c.drawImage(t.image,t.col*r+r*t.currentFrame,t.row*o,r,o,e.x,e.y,n,i)}return h.width=u,h.height=a,y(),window.addEventListener("resize",y,!1),{render:function(e){let h,f,l=s.entities();if(c.fillStyle="blue",c.fillRect(0,0,u,a),s.accelerating())for(f=r.length-1;f>=0;f--)r[f].update(e);for(f=0;f<l.length;f++)(h=l[f])instanceof o?(p=c,(g=h).y<g.invisPointY?I(n,g,2*g.width,6*g.height):(p.fillStyle="white",p.fillRect(0,g.y+g.height,u,10))):h instanceof i&&I(t,d=h,d.width,d.height);var d,p,g},INITIAL_WIDTH:function(){return u},INITIAL_HEIGHT:function(){return a},currentWidth:function(){return d},currentHeight:function(){return l},canvas:function(){return h}}}(),s=function(){let t,e,n,c,a,u,f,l=!0,d=1,p=d,g=!1,m=function(){let t=0,e=2*r.INITIAL_HEIGHT();return function(){let n=(i=4,Math.floor(Math.random()*Math.floor(i)));var i;let s,h;for(t++,console.log("wave "+t),5==t&&(e=r.INITIAL_HEIGHT()/2,console.log("Activating invisibilty gene...")),e>=80&&(e-=10),h=0;h<4;h++)h!==n&&I(new o(s=r.INITIAL_WIDTH()/4*h+20,-10,p,e))}}();function y(){let t;if(l){for(p=0,console.log("STOP..."),t=0;t<n.length;t++)n[t].speed=p;l=!1}else{for(console.log("hammertime"),p=d,t=0;t<n.length;t++)n[t].speed=p,n[t].y+=p;l=!0}}function I(t){e.push(t),t instanceof i?c=t:t instanceof o&&n.push(t)}return{start:function(){if(console.log("game start"),e=[],n=[],a=!1,u=0,f=[],t=0,"undefined"!=typeof Storage)try{f=JSON.parse(localStorage.sharkAttackScores)}catch(t){f=[]}this.addEntity(new i(0,r.INITIAL_HEIGHT()-60)),m(),g||(requestAnimationFrame(this.update.bind(this)),g=!0)},update:function(i){let s,u,f=[],d=!1,p=c.y-c.height,I=r.INITIAL_HEIGHT()/4,w=Math.min((i-t)/1e3,.05);if(t=i,a)g=!1;else{for(h.update(w),u=0;u<e.length;u++)(s=e[u]).update(w),s instanceof o&&!d&&s.y>=I&&s.y<I+s.speed&&(m(),d=!0),s instanceof o&&l&&s.y>=p&&s.y<p+s.speed&&y(),h.offScreenEntities().includes(s)&&f.push(s);!function(t){function i(e){return!t.includes(e)}t&&(e=e.filter(i),n=n.filter(i),t.includes(c)&&(c=void 0))}(f),h.clearOffScreenEntities(),d=!1,r.render(w),requestAnimationFrame(this.update.bind(this))}},addEntity:I,setGameOver:function(){var t;a||(console.log("game over"),a=!0,t=Math.round(s.score()),f.push(t),f.sort(function(t,e){return e-t}),f=f.slice(0,10),"undefined"!=typeof Storage&&(localStorage.invadersScores=JSON.stringify(f)))},addScore:function(t){u+=t},toggleAcceleration:y,accelerating:function(){return l},score:function(){return u},highScores:function(){return f},gameOver:function(){return a},entities:function(){return e},enemies:function(){return n},player:function(){return c}}}();let c={49:0,50:1,51:2,52:3};function a(t){let e=r.currentWidth()/r.INITIAL_WIDTH();return{x:(t.pageX-function(t){let e=0;do{isNaN(t.offsetLeft)||(e+=t.offsetLeft),t=t.offsetParent}while(null!==t);return e}(r.canvas()))/e,y:(t.pageY-function(t){let e=0;do{isNaN(t.offsetTop)||(e+=t.offsetTop),t=t.offsetParent}while(null!==t);return e}(r.canvas()))/e}}document.body.addEventListener("keydown",function(t){let e=t.which||t.keyCode;void 0!==c[e]&&(t.preventDefault(),s.player()&&s.player().move(c[e]),s.accelerating()||s.toggleAcceleration())}),r.canvas().addEventListener("touchstart",function(t){let e,n,i=t.changedTouches;t.preventDefault();for(let t=i.length-1;t>=0;t--)n=(e=a(i[t])).x<.25*r.INITIAL_WIDTH()?0:e.x<.5*r.INITIAL_WIDTH()?1:e.x<.75*r.INITIAL_WIDTH()?2:3,s.player().move(n),s.accelerating()||s.toggleAcceleration()}),s.start()}();